
<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8">
<title>Hinderløp – Arcade</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    background:#0f0f0f;
    color:white;
    font-family:Arial, sans-serif;
    text-align:center;
    margin:0;
    padding:20px;
    user-select:none;
  }

  #gameBox {
    width:520px;
    height:240px;
    margin:20px auto;
    background:#222;
    position:relative;
    overflow:hidden;
    border:2px solid white;
  }

  #player {
    width:40px;
    height:40px;
    background:#00ffff;
    position:absolute;
    left:60px;
    bottom:0;
  }

  .obstacle {
    position:absolute;
    border-radius:4px;
  }

  #score, #highScore {
    font-size:18px;
    margin:5px;
  }

  #gameOver {
    font-size:26px;
    color:red;
    display:none;
  }

  button {
    margin-top:10px;
    padding:8px 14px;
    font-size:16px;
    cursor:pointer;
  }
</style>
</head>

<body>
<h1>Hinderløp – Arcade</h1>
<div id="score">Poeng: 0</div>
<div id="highScore">High Score: 0</div>

<div id="gameBox">
  <div id="player"></div>
</div>

<div id="gameOver">GAME OVER</div>
<button onclick="startGame()">Spill igjen</button>

<script>
const player = document.getElementById("player");
const gameBox = document.getElementById("gameBox");
const scoreEl = document.getElementById("score");
const highScoreEl = document.getElementById("highScore");
const gameOverEl = document.getElementById("gameOver");

let score = 0;
let highScore = localStorage.getItem("hinderHigh") || 0;
highScoreEl.textContent = "High Score: " + highScore;

let obstacles = [];
let gameLoopId;
let obstacleTimer;

let jumping = false;
let velocity = 0;
const gravity = 2;
const jumpPower = 25;

let baseSpeed = 5;

const colors = ["#ff3b3b", "#ff00ff", "#ffaa00", "#00ff00", "#00aaff"];

function startGame() {
  score = 0;
  baseSpeed = 5;
  scoreEl.textContent = "Poeng: 0";
  gameOverEl.style.display = "none";

  obstacles.forEach(o => o.remove());
  obstacles = [];

  player.style.bottom = "0px";
  velocity = 0;
  jumping = false;

  clearInterval(gameLoopId);
  clearInterval(obstacleTimer);

  gameLoopId = setInterval(gameLoop, 20);
  obstacleTimer = setInterval(createObstacle, 1200);
}

function gameLoop() {
  // hopp
  if (jumping) {
    let bottom = parseInt(player.style.bottom);
    bottom += velocity;
    velocity -= gravity;

    if (bottom <= 0) {
      bottom = 0;
      jumping = false;
    }

    player.style.bottom = bottom + "px";
  }

  obstacles.forEach((obs, i) => {
    obs.x -= obs.speed;
    obs.style.left = obs.x + "px";

    // kollisjon (100 % korrekt)
    const p = player.getBoundingClientRect();
    const o = obs.getBoundingClientRect();

    if (
      p.right > o.left &&
      p.left < o.right &&
      p.bottom > o.top &&
      p.top < o.bottom
    ) {
      endGame();
    }

    // poeng + økende fart
    if (obs.x + obs.offsetWidth < 0) {
      obs.remove();
      obstacles.splice(i,1);
      score++;
      scoreEl.textContent = "Poeng: " + score;
      baseSpeed += 0.1; // blir raskere over tid
    }
  });
}

function createObstacle() {
  const obs = document.createElement("div");
  obs.className = "obstacle";

  const width = 20 + Math.random()*40;
  const height = 20 + Math.random()*70;

  obs.style.width = width + "px";
  obs.style.height = height + "px";
  obs.style.background = colors[Math.floor(Math.random()*colors.length)];

  obs.x = gameBox.offsetWidth;
  obs.speed = baseSpeed + Math.random()*2;
  obs.style.left = obs.x + "px";

  // ✈️ 30 % sjanse for flygende hindring
  if (Math.random() < 0.3) {
    obs.style.bottom = (60 + Math.random()*100) + "px";
  } else {
    obs.style.bottom = "0px";
  }

  gameBox.appendChild(obs);
  obstacles.push(obs);
}

function endGame() {
  clearInterval(gameLoopId);
  clearInterval(obstacleTimer);
  gameOverEl.style.display = "block";

  if (score > highScore) {
    highScore = score;
    localStorage.setItem("hinderHigh", highScore);
    highScoreEl.textContent = "High Score: " + highScore;
  }
}

document.addEventListener("keydown", e => {
  if (e.code === "Space" && !jumping) {
    jumping = true;
    velocity = jumpPower;
  }
});

startGame();
</script>
</body>
</html>
