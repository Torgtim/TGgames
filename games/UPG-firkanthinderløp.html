
<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8">
<title>Firkanthinderløp – Kamera Runner</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  background:#0f0f0f;
  color:white;
  font-family:Arial;
  margin:0;
  padding:20px;
}
#gameBox{
  width:600px;
  height:260px;
  background:#222;
  border:2px solid white;
  margin:20px auto;
  position:relative;
  overflow:hidden;
}
#player{
  width:40px;
  height:40px;
  background:#00ffff;
  position:absolute;
  left:60px;
  bottom:0;
}
.obstacle{
  position:absolute;
  background:red;
}
#ui{
  text-align:center;
  font-size:15px;
}
#controls{
  position:absolute;
  left:10px;
  top:10px;
  font-size:13px;
  opacity:0.85;
}
#gameOver{
  text-align:center;
  font-size:28px;
  color:red;
  display:none;
}
button{
  padding:8px 14px;
  font-size:16px;
  margin:10px auto;
  display:block;
}
</style>
</head>

<body>

<h2 style="text-align:center">Firkanthinderløp – Kamera Edition</h2>

<div id="controls">
<b>KONTROLLER</b><br>
Space – Hopp / Dobbelhopp<br>
X – Dash
</div>

<div id="ui"></div>

<div id="gameBox">
  <div id="player"></div>
</div>

<div id="gameOver">GAME OVER</div>
<button>Spill igjen</button>

<script>
const player = document.getElementById("player");
const gameBox = document.getElementById("gameBox");
const ui = document.getElementById("ui");
const gameOverEl = document.getElementById("gameOver");
const restartBtn = document.querySelector("button");

let obstacles = [];
let gameRunning = true;

// Kamera & score
let cameraX = 0;
let distance = 0;
let hiScore = localStorage.getItem("runnerHi") || 0;

// Physics
let yVel = 0;
const gravity = 2;
let jumpCount = 0;
const maxJumps = 2;

// Dash
let dashFrames = 0;
let dashCooldown = 0;

function startGame(){
  obstacles.forEach(o=>o.el.remove());
  obstacles=[];
  cameraX = 0;
  distance = 0;
  yVel = 0;
  jumpCount = 0;
  dashFrames = 0;
  dashCooldown = 0;
  player.style.left = "60px";
  player.style.bottom = "0px";
  gameOverEl.style.display = "none";
  gameRunning = true;
}
startGame();

function loop(){
  requestAnimationFrame(loop);
  if(!gameRunning) return;

  // Gravity
  yVel += gravity;
  let bottom = parseInt(player.style.bottom) - yVel;
  if(bottom <= 0){
    bottom = 0;
    yVel = 0;
    jumpCount = 0;
  }
  player.style.bottom = bottom + "px";

  // Dash
  if(dashFrames > 0){
    player.style.left = parseInt(player.style.left) + 14 + "px";
    dashFrames--;
  }
  if(dashCooldown > 0) dashCooldown -= 1/60;

  // Kamera følger spiller
  const playerX = parseInt(player.style.left);
  cameraX = playerX - 60;

  // Hindringer
  obstacles.forEach((o,i)=>{
    o.el.style.left = (o.x - cameraX) + "px";

    if(collide(player, o.el)){
      endGame();
    }

    if(o.x - cameraX + o.width < 0){
      o.el.remove();
      obstacles.splice(i,1);
    }
  });

  // Score
  distance = Math.floor(cameraX / 10);
  if(distance > hiScore){
    hiScore = distance;
    localStorage.setItem("runnerHi", hiScore);
  }

  ui.innerHTML = `Avstand: ${distance}m | Hi-score: ${hiScore}m`;
}
loop();

// Controls
document.addEventListener("keydown", e=>{
  if(e.code === "Space" && jumpCount < maxJumps){
    yVel = -25;
    jumpCount++;
  }
  if(e.code === "KeyX" && dashCooldown <= 0){
    dashFrames = 10;
    dashCooldown = 2;
  }
});

// Spawn obstacles
setInterval(()=>{
  if(!gameRunning) return;

  const el = document.createElement("div");
  el.className = "obstacle";

  const width = 50 + Math.random()*60;
  const height = 60 + Math.random()*100;

  el.style.width = width + "px";
  el.style.height = height + "px";
  el.style.bottom = "0px";

  const x = cameraX + gameBox.offsetWidth + 100;
  el.style.left = (x - cameraX) + "px";

  gameBox.appendChild(el);
  obstacles.push({el, x, width});
}, 1400);

// Collision
function collide(a,b){
  const r1=a.getBoundingClientRect();
  const r2=b.getBoundingClientRect();
  return r1.right>r2.left && r1.left<r2.right &&
         r1.bottom>r2.top && r1.top<r2.bottom;
}

// Game over
function endGame(){
  gameRunning = false;
  gameOverEl.style.display = "block";
}

// Restart
restartBtn.addEventListener("click", ()=>{
  if(!gameRunning) startGame();
});
</script>

</body>
</html>
