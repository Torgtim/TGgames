<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8">
<title>CHAOS MODE – TG Games Studio</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;
  background:black;
  color:white;
  font-family:monospace;
}
#world{
  width:600px;
  height:300px;
  border:2px solid white;
  margin:20px auto 0;
  position:relative;
  overflow:hidden;
  background:#111;
}
#player{
  width:30px;
  height:30px;
  background:cyan;
  position:absolute;
  left:100px;
  bottom:0;
}
.platform{
  position:absolute;
  background:#444;
}
.particle{
  position:absolute;
  width:6px;
  height:6px;
  background:lime;
}

#info{
  text-align:center;
  font-size:12px;
  opacity:0.8;
  margin-bottom:10px;
}

/* ☁️ SKYER UNDER SPILLET */
#skyArea{
  width:600px;
  height:120px;
  margin:0 auto;
  position:relative;
  overflow:hidden;
}

.cloud{
  position:absolute;
  bottom:20px;
  width:80px;
  height:30px;
  background:#333;
  border-radius:20px;
  opacity:0.6;
  animation: drift linear infinite;
}

.cloud::before,
.cloud::after{
  content:"";
  position:absolute;
  background:#333;
  width:40px;
  height:40px;
  border-radius:50%;
  top:-20px;
}

.cloud::before{ left:10px; }
.cloud::after{ left:30px; }

@keyframes drift{
  from{ transform:translateX(-120px); }
  to{ transform:translateX(720px); }
}
</style>
</head>

<body>

<div id="info">
<b>CHAOS MODE</b><br>
WASD / Piler = Bevegelse |
Space = Hopp |
X = Dash |
C = Flip |
V = Teleport |
Z = Spinn |
Shift = Kaos |
B = Spawn ting |
N = Fargekaos |
M = Gravitasjon
</div>

<div id="world">
  <div id="player"></div>
</div>

<div id="skyArea"></div>

<script>
const world = document.getElementById("world");
const player = document.getElementById("player");
const skyArea = document.getElementById("skyArea");

let px=100, py=0;
let vx=0, vy=0;
let gravity=1.8;
let chaos=false;
let spin=0;

/* PLATFORMS */
const platforms=[];
for(let i=0;i<8;i++){
  const p=document.createElement("div");
  p.className="platform";
  p.style.width=80+Math.random()*100+"px";
  p.style.height="12px";
  p.x=Math.random()*500;
  p.y=Math.random()*250;
  p.style.left=p.x+"px";
  p.style.bottom=p.y+"px";
  world.appendChild(p);
  platforms.push(p);
}

/* MAIN LOOP */
function loop(){
  requestAnimationFrame(loop);

  vy -= gravity;
  px += vx;
  py += vy;

  platforms.forEach(p=>{
    const pr=p.getBoundingClientRect();
    const pl=player.getBoundingClientRect();
    if(pl.bottom>pr.top && pl.bottom<pr.top+20 &&
       pl.right>pr.left && pl.left<pr.right && vy<0){
      py=p.y+12;
      vy=0;
    }
  });

  /* WRAP-AROUND WORLD */
  if(px>600) px=-30;
  if(px<-30) px=600;
  if(py>300) py=-30;
  if(py<-30) py=300;

  player.style.left=px+"px";
  player.style.bottom=py+"px";
  player.style.transform=`rotate(${spin}deg)`;

  if(chaos){
    spin+=10;
    spawnParticle();
  }
}
loop();

/* PARTICLES */
function spawnParticle(){
  const d=document.createElement("div");
  d.className="particle";
  d.style.left=px+15+"px";
  d.style.bottom=py+15+"px";
  d.style.background=`hsl(${Math.random()*360},100%,50%)`;
  world.appendChild(d);
  setTimeout(()=>d.remove(),600);
}

/* ☁️ SKYER */
function spawnCloud(){
  const c=document.createElement("div");
  c.className="cloud";
  c.style.top=Math.random()*60+"px";
  c.style.opacity=0.3+Math.random()*0.4;
  c.style.animationDuration=(20+Math.random()*20)+"s";
  skyArea.appendChild(c);
  setTimeout(()=>c.remove(),40000);
}
setInterval(spawnCloud,2500);

/* INPUT */
document.addEventListener("keydown",e=>{
  if(e.code==="ArrowRight"||e.code==="KeyD") vx=4;
  if(e.code==="ArrowLeft"||e.code==="KeyA") vx=-4;
  if(e.code==="Space") vy=18;

  if(e.code==="KeyX"){
    vx*=3;
    chaos=true;
    setTimeout(()=>chaos=false,400);
  }

  if(e.code==="KeyC"){
    gravity*=-1;
  }

  if(e.code==="KeyV"){
    px=Math.random()*560;
    py=Math.random()*260;
  }

  if(e.code==="KeyZ"){
    spin+=90;
  }

  if(e.code==="ShiftLeft"){
    chaos=!chaos;
  }

  if(e.code==="KeyB"){
    const p=document.createElement("div");
    p.className="platform";
    p.style.width="60px";
    p.style.height="12px";
    p.x=Math.random()*500;
    p.y=Math.random()*260;
    p.style.left=p.x+"px";
    p.style.bottom=p.y+"px";
    world.appendChild(p);
    platforms.push(p);
  }

  if(e.code==="KeyN"){
    player.style.background=`hsl(${Math.random()*360},100%,50%)`;
  }

  if(e.code==="KeyM"){
    gravity=Math.random()*4+0.5;
  }
});

document.addEventListener("keyup",e=>{
  if(["ArrowRight","ArrowLeft","KeyA","KeyD"].includes(e.code)){
    vx=0;
  }
});
</script>

</body>
</html>
